# Тестовое задание для стажера на позицию

# «Программист на языке C#»

## Задание

Реализовать RESTful-сервис с 3 методами. Методы описаны ниже.

В рамках выполнения задания следует написать приложение WebApi, которое реализует 3 метода http, составляющие данный RESTAPI сервис.

Реализация графической части в рамках задания не требуется. Для проверки сервиса необходимо использовать Swagger.

**Общее описание задачи**

В рамках данного задания необходимо реализовать только backend сервиса. Перечень используемых технологий представлен ниже.

Представим, что в рамках предметной области рассматриваются результаты некоторого научного эксперимента, проведенного множество раз в разные дни. Данные каждого эксперимента характеризуются следующим набором значений: дата и время начала эксперимента, затраченное время на проведение эксперимента в секундах и некий показатель (результат) эксперимента. Набор результатов эксперимента получается в рамках первого метода в виде файла. Ниже представлено подробное описание формата файла и самого метода.

Второй и третий методы направлены на реализацию различных выборок данных. Их описание расположено ниже.

Требуется реализовать базу данных, которая будет содержать следующие таблицы:

- Files. Содержит данные получаемых файлов в рамках первого метода;
- Values. Содержит верифицированные данные, полученные из файла в методе 1, в том числе имя файла;
- Results. Содержит данные, вычисляемые на основе данных, полученных из файла в методе 1.

Необходимо спроектировать и реализовать базу данных, содержимое (поля) таблиц, их ограничения, первичные и внешние ключи.

Если база данных не существует (или не существуют одна или несколько таблиц), необходимо пересоздать базу данных. При штатном варианте использования база данных создается один раз при первом использовании сервиса.

В данном сервисе реализуются следующие конечные точки:

- /science/files/
- /science/results/
- /science/values/

К данным точкам будут выполняться http-запросы в соответствие с концепцией RESTful-сервиса.

**Первый**** метод**

_post /science/files/_

Реализует метод httppost к точке /science/files/.

Принимает файл вида \*.csv. В данном файле на каждой новой строке представлено значение следующего вида:

{Дата и время в формате ГГГГ-ММ-ДД\_чч-мм-сс};{Целочисленное значение времени в секундах};{Показатель в виде числа с плавающей запятой}

Пример:

**2022-03-18\_09-18-17;1744;1632,472**

Для простоты в дальнейшем будем именовать эти данные следующим образом:

_{Дата и время};{Время};{Показатель}_

При получении файла необходимо выполнить валидацию.

Валидация:

- Дата не может быть позже текущей и раньше 01.01.2000 00:00
- Время проведения эксперимента не может быть меньше 0
- Значение показателя не может быть меньше 0
- Количество строк в файле не может быть меньше 1 и больше 10 000

Необходимо отбрасывать строки, которые не проходят валидацию хотя бы по одному из указанных критериев, в том числе по количеству строк в файле.

Сохранять информацию о файле (автор и дата создания) и его данные в базу данных в таблицу Files.

Если файл с таким именем уже существует, перезаписывать значения в базе.

Следующим шагом файл разбирается, значения, прошедшие валидацию, записываются в базу данных в таблицу Values.

Для каждого файла необходимо вычислить указанные далее значения и поместить в таблицу Results в виде отдельной записи.

Подсчитываются следующие значения:

- Время запуска первого по времени эксперимента
- Время запуска последнего по времени эксперимента
- Максимальное время проведения эксперимента
- Минимальное время проведения эксперимента
- Среднее время проведения эксперимента
- Среднее значение по показателям
- Медиана по показателям
- Максимальное значение показателя
- Минимальное значение показателя
- Количество выполненных экспериментов

_ **Рекомендации:** _

1. Не читать файл полностью в память
2. Рассмотреть возможность реализации в виде одной или нескольких асинхронных операций.

**Второй**** метод**

_get /science/results/_

Реализуется метод httpget к конечной точке /science/results/.

Данный метод должен возвращать вычисленные (обработанные) данные о научных экспериментах из таблиц базы данных. Учесть применение фильтров (описываются далее).

Возвращаемые данные должны быть представлены в формате JSON в теле http-ответа. Структуру (структуры) возвращаемых данные определить самостоятельно.

Могут применяться фильтры:

- По имени файла:

Запрос gethttps://{...}/science/results?fileName=experiment.csv

Предоставить данные по указанному файлу из таблицы Results.

- По среднему показателю (в диапазоне). Предоставить данные о файлах, в которых среднее значение показателя научных экспериментов соответствует указанному диапазону.
- По среднему времени (в диапазоне). Предоставить данные о файлах, в которых значение среднего времени выполнения эксперимента соответствует указанному диапазону.

**Третий**** метод**

_get /science/values/{fileName}_

Реализуетсяметодом http get кточке /science/values/{fileName}.

Метод позволяет получить записи из таблицы Values по имени файла, в котором эти данные расположены.

Метод возвращает данные в формате JSON в теле http-ответа. Формат структуры JSON определить самостоятельно с учетом структуры таблицы Values.

**Требования к присылаемым решениям:**

- .NET 6 (C# версии 9) или более поздняя версия языка и платформы
- WebApi
- Swagger
- СУБД: SQLite
- Для работы с БД: EFCore
- Уделите внимание быстродействию
- Уделите внимание архитектуре и стилю кода проекта
- Обязательно наличие комментариев в коде, в том числе в формате XML
- **Желательно** реализовать unit-тесты (Выбор технологий не ограничен, но выбрать полезные можно из NUnit/XUnit, AutoFixture, Moq)

**Максимальное время на выполнение задания:** одна неделя.
